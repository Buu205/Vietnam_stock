{
  "name": "Technical Indicators Schema",
  "version": "1.0.0",
  "description": "Schema for technical indicators and signals",
  "type": "object",
  "properties": {
    "symbol": {
      "type": "string",
      "description": "Stock symbol",
      "pattern": "^[A-Z0-9]{2,10}$"
    },
    "date": {
      "type": "string",
      "format": "date",
      "description": "Trading date"
    },
    "close": {
      "type": "number",
      "minimum": 0,
      "description": "Closing price in VND"
    },
    "volume": {
      "type": "integer",
      "minimum": 0,
      "description": "Trading volume"
    },
    "moving_averages": {
      "type": "object",
      "properties": {
        "sma_5": {"type": "number", "description": "Simple Moving Average 5 periods"},
        "sma_10": {"type": "number", "description": "Simple Moving Average 10 periods"},
        "sma_20": {"type": "number", "description": "Simple Moving Average 20 periods"},
        "sma_50": {"type": "number", "description": "Simple Moving Average 50 periods"},
        "sma_100": {"type": "number", "description": "Simple Moving Average 100 periods"},
        "sma_200": {"type": "number", "description": "Simple Moving Average 200 periods"},
        "ema_12": {"type": "number", "description": "Exponential Moving Average 12 periods"},
        "ema_26": {"type": "number", "description": "Exponential Moving Average 26 periods"},
        "ema_50": {"type": "number", "description": "Exponential Moving Average 50 periods"}
      }
    },
    "oscillators": {
      "type": "object",
      "properties": {
        "rsi_14": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Relative Strength Index 14 periods"
        },
        "rsi_21": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Relative Strength Index 21 periods"
        },
        "stoch_k": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Stochastic %K"
        },
        "stoch_d": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Stochastic %D"
        },
        "williams_r": {
          "type": "number",
          "minimum": -100,
          "maximum": 0,
          "description": "Williams %R"
        }
      }
    },
    "momentum": {
      "type": "object",
      "properties": {
        "macd": {"type": "number", "description": "MACD line"},
        "macd_signal": {"type": "number", "description": "MACD signal line"},
        "macd_histogram": {"type": "number", "description": "MACD histogram"},
        "roc": {"type": "number", "description": "Rate of Change"},
        "momentum": {"type": "number", "description": "Momentum indicator"}
      }
    },
    "volatility": {
      "type": "object",
      "properties": {
        "atr_14": {"type": "number", "minimum": 0, "description": "Average True Range 14 periods"},
        "atr_21": {"type": "number", "minimum": 0, "description": "Average True Range 21 periods"},
        "bb_upper": {"type": "number", "description": "Bollinger Bands Upper"},
        "bb_middle": {"type": "number", "description": "Bollinger Bands Middle"},
        "bb_lower": {"type": "number", "description": "Bollinger Bands Lower"},
        "bb_width": {"type": "number", "minimum": 0, "description": "Bollinger Bands Width"},
        "bb_position": {"type": "number", "description": "Bollinger Bands Position"}
      }
    },
    "volume_indicators": {
      "type": "object",
      "properties": {
        "obv": {"type": "number", "description": "On Balance Volume"},
        "ad_line": {"type": "number", "description": "Accumulation/Distribution Line"},
        "cmf": {"type": "number", "description": "Chaikin Money Flow"},
        "mfi": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Money Flow Index"
        },
        "vwap": {"type": "number", "description": "Volume Weighted Average Price"}
      }
    },
    "trend_indicators": {
      "type": "object",
      "properties": {
        "adx": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Average Directional Index"
        },
        "di_plus": {"type": "number", "description": "Directional Indicator +"},
        "di_minus": {"type": "number", "description": "Directional Indicator -"},
        "aroon_up": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Aroon Up"
        },
        "aroon_down": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Aroon Down"
        }
      }
    },
    "signals": {
      "type": "object",
      "properties": {
        "ma_cross": {
          "type": "string",
          "enum": ["bullish", "bearish", "neutral"],
          "description": "Moving Average Crossover Signal"
        },
        "rsi_signal": {
          "type": "string",
          "enum": ["overbought", "oversold", "neutral"],
          "description": "RSI Signal"
        },
        "macd_signal": {
          "type": "string",
          "enum": ["bullish", "bearish", "neutral"],
          "description": "MACD Signal"
        },
        "bb_signal": {
          "type": "string",
          "enum": ["squeeze", "expansion", "neutral"],
          "description": "Bollinger Bands Signal"
        },
        "overall_signal": {
          "type": "string",
          "enum": ["strong_buy", "buy", "hold", "sell", "strong_sell"],
          "description": "Overall Technical Signal"
        }
      }
    },
    "market_breadth": {
      "type": "object",
      "properties": {
        "advance_decline": {"type": "number", "description": "Advance-Decline Line"},
        "new_highs": {"type": "integer", "minimum": 0, "description": "New 52-week highs"},
        "new_lows": {"type": "integer", "minimum": 0, "description": "New 52-week lows"},
        "advance_decline_ratio": {"type": "number", "minimum": 0, "description": "Advance-Decline Ratio"},
        "mcclellan_oscillator": {"type": "number", "description": "McClellan Oscillator"},
        "mcclellan_summation": {"type": "number", "description": "McClellan Summation Index"}
      }
    },
    "sector_rotation": {
      "type": "object",
      "properties": {
        "sector": {"type": "string", "description": "Sector name"},
        "relative_strength": {"type": "number", "description": "Relative strength vs market"},
        "momentum_score": {"type": "number", "description": "Sector momentum score"},
        "rotation_phase": {
          "type": "string",
          "enum": ["early_cycle", "mid_cycle", "late_cycle", "recession"],
          "description": "Sector rotation phase"
        }
      }
    }
  },
  "required": ["symbol", "date", "close", "volume"],
  "additionalProperties": false,
  "validation_rules": {
    "rsi_range": {
      "description": "RSI values should be between 0 and 100",
      "min_value": 0,
      "max_value": 100
    },
    "moving_average_consistency": {
      "description": "Longer period MAs should be smoother than shorter period MAs"
    },
    "signal_consistency": {
      "description": "Signals should be consistent with underlying indicator values"
    },
    "date_consistency": {
      "description": "All indicators should be calculated for the same date"
    }
  }
}
